{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.recoilPersist = void 0;\n/**\n * Recoil module to persist state to storage\n *\n * @param config Optional configuration object\n * @param config.key Used as key in local storage, defaults to `recoil-persist`\n * @param config.storage Local storage to use, defaults to `localStorage`\n */\nconst recoilPersist = (config = {}) => {\n  if (typeof window === 'undefined') {\n    return {\n      persistAtom: () => {}\n    };\n  }\n  const {\n    key = 'recoil-persist',\n    storage = localStorage,\n    converter = JSON\n  } = config;\n  const persistAtom = ({\n    onSet,\n    node,\n    trigger,\n    setSelf\n  }) => {\n    if (trigger === 'get') {\n      const state = getState();\n      if (typeof state.then === 'function') {\n        state.then(s => {\n          if (s.hasOwnProperty(node.key)) {\n            setSelf(s[node.key]);\n          }\n        });\n      }\n      if (state.hasOwnProperty(node.key)) {\n        setSelf(state[node.key]);\n      }\n    }\n    onSet(async (newValue, _, isReset) => {\n      const state = getState();\n      if (typeof state.then === 'function') {\n        state.then(s => updateState(newValue, s, node.key, isReset));\n      } else {\n        updateState(newValue, state, node.key, isReset);\n      }\n    });\n  };\n  const updateState = (newValue, state, key, isReset) => {\n    if (isReset) {\n      delete state[key];\n    } else {\n      state[key] = newValue;\n    }\n    setState(state);\n  };\n  const getState = () => {\n    const toParse = storage.getItem(key);\n    if (toParse === null || toParse === undefined) {\n      return {};\n    }\n    if (typeof toParse === 'string') {\n      return parseState(toParse);\n    }\n    if (typeof toParse.then === 'function') {\n      return toParse.then(parseState);\n    }\n    return {};\n  };\n  const parseState = state => {\n    if (state === undefined) {\n      return {};\n    }\n    try {\n      return converter.parse(state);\n    } catch (e) {\n      console.error(e);\n      return {};\n    }\n  };\n  const setState = state => {\n    try {\n      if (typeof storage.mergeItem === 'function') {\n        storage.mergeItem(key, converter.stringify(state));\n      } else {\n        storage.setItem(key, converter.stringify(state));\n      }\n    } catch (e) {\n      console.error(e);\n    }\n  };\n  return {\n    persistAtom\n  };\n};\nexports.recoilPersist = recoilPersist;","map":{"version":3,"names":["Object","defineProperty","exports","value","recoilPersist","config","window","persistAtom","key","storage","localStorage","converter","JSON","onSet","node","trigger","setSelf","state","getState","then","s","hasOwnProperty","newValue","_","isReset","updateState","setState","toParse","getItem","undefined","parseState","parse","e","console","error","mergeItem","stringify","setItem"],"sources":["/Users/zoe/Documents/Wishread/node_modules/recoil-persist/dist/index.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.recoilPersist = void 0;\n/**\n * Recoil module to persist state to storage\n *\n * @param config Optional configuration object\n * @param config.key Used as key in local storage, defaults to `recoil-persist`\n * @param config.storage Local storage to use, defaults to `localStorage`\n */\nconst recoilPersist = (config = {}) => {\n    if (typeof window === 'undefined') {\n        return {\n            persistAtom: () => { },\n        };\n    }\n    const { key = 'recoil-persist', storage = localStorage, converter = JSON } = config;\n    const persistAtom = ({ onSet, node, trigger, setSelf }) => {\n        if (trigger === 'get') {\n            const state = getState();\n            if (typeof state.then === 'function') {\n                state.then((s) => {\n                    if (s.hasOwnProperty(node.key)) {\n                        setSelf(s[node.key]);\n                    }\n                });\n            }\n            if (state.hasOwnProperty(node.key)) {\n                setSelf(state[node.key]);\n            }\n        }\n        onSet(async (newValue, _, isReset) => {\n            const state = getState();\n            if (typeof state.then === 'function') {\n                state.then((s) => updateState(newValue, s, node.key, isReset));\n            }\n            else {\n                updateState(newValue, state, node.key, isReset);\n            }\n        });\n    };\n    const updateState = (newValue, state, key, isReset) => {\n        if (isReset) {\n            delete state[key];\n        }\n        else {\n            state[key] = newValue;\n        }\n        setState(state);\n    };\n    const getState = () => {\n        const toParse = storage.getItem(key);\n        if (toParse === null || toParse === undefined) {\n            return {};\n        }\n        if (typeof toParse === 'string') {\n            return parseState(toParse);\n        }\n        if (typeof toParse.then === 'function') {\n            return toParse.then(parseState);\n        }\n        return {};\n    };\n    const parseState = (state) => {\n        if (state === undefined) {\n            return {};\n        }\n        try {\n            return converter.parse(state);\n        }\n        catch (e) {\n            console.error(e);\n            return {};\n        }\n    };\n    const setState = (state) => {\n        try {\n            if (typeof storage.mergeItem === 'function') {\n                storage.mergeItem(key, converter.stringify(state));\n            }\n            else {\n                storage.setItem(key, converter.stringify(state));\n            }\n        }\n        catch (e) {\n            console.error(e);\n        }\n    };\n    return { persistAtom };\n};\nexports.recoilPersist = recoilPersist;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}