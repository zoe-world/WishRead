{"ast":null,"code":"import { atom, selector, selectorFamily } from \"recoil\";\nimport { recoilPersist } from \"recoil-persist\";\nconst {\n  persistAtom\n} = recoilPersist();\n\n// kakao API 호출\nconst KAKAO_API_KEY = process.env.REACT_APP_KAKAO_API_KEY;\n\n// 검색한 책\nexport const bookDataState = atom({\n  key: \"bookDataState\",\n  default: [],\n  effects_UNSTABLE: [persistAtom]\n});\n\n// 검색어\nexport const searchInfoState = atom({\n  key: \"searchInfoState\",\n  default: \"\"\n});\n\n// 상세보기 책\nexport const bookDetailState = atom({\n  key: \"bookDetailState\",\n  default: [],\n  effects_UNSTABLE: [persistAtom]\n});\n\n// 북마크한 책\nexport const bookmarkState = atom({\n  key: \"bookmark\",\n  default: [],\n  effects_UNSTABLE: [persistAtom]\n});\nexport const detailBookSelector = selector({\n  key: \"detailBookSelector\",\n  get: ({\n    get\n  }) => {\n    const bookState = get(bookDataState);\n    const findItem = bookState.find(item => item.watch === true);\n    return findItem;\n  },\n  set: ({\n    set,\n    get\n  }, newValue) => {\n    const bookState = get(bookDataState);\n    const updatedData = bookState.map(item => {\n      if (item === newValue) {\n        return {\n          ...item,\n          watch: true\n        };\n      }\n      return {\n        ...item,\n        watch: false\n      };\n    });\n    set(bookDataState, updatedData);\n    set(bookDetailState, newValue);\n  }\n});\n\n// watch true 로 바꾸는 기능\nexport const filteredBookSelector = selectorFamily({\n  key: \"filteredBookSelector\",\n  get: bookCode => ({\n    get\n  }) => {\n    const bookState = get(bookDataState);\n    const findItem = bookState === null || bookState === void 0 ? void 0 : bookState.find(item => {\n      return item.isbn.split(\" \").join(\"\") === bookCode;\n    });\n    return findItem === null || findItem === void 0 ? void 0 : findItem.watch;\n  },\n  set: bookCode => ({\n    set,\n    get\n  }, newValue) => {\n    const bookState = get(bookDataState);\n    console.log(\"set함수\", bookState);\n    const updatedData = bookState === null || bookState === void 0 ? void 0 : bookState.map(item => {\n      let isbn = item.isbn;\n      isbn = isbn.split(\" \").join(\"\");\n      if (isbn == bookCode) {\n        return {\n          ...item,\n          watch: newValue\n        };\n      }\n      return item;\n    });\n    set(bookDataState, updatedData);\n  }\n});","map":{"version":3,"names":["atom","selector","selectorFamily","recoilPersist","persistAtom","KAKAO_API_KEY","process","env","REACT_APP_KAKAO_API_KEY","bookDataState","key","default","effects_UNSTABLE","searchInfoState","bookDetailState","bookmarkState","detailBookSelector","get","bookState","findItem","find","item","watch","set","newValue","updatedData","map","filteredBookSelector","bookCode","isbn","split","join","console","log"],"sources":["/Users/zoe/Documents/Wishread/src/recoil/books.ts"],"sourcesContent":["import { bookData } from \"recoil/books\";\nimport axios, { AxiosError } from \"axios\";\nimport { BookDTO } from \"components/types/searchType\";\nimport { atom, selector, selectorFamily } from \"recoil\";\nimport { recoilPersist } from \"recoil-persist\";\n\nconst { persistAtom } = recoilPersist();\n\n// kakao API 호출\nconst KAKAO_API_KEY = process.env.REACT_APP_KAKAO_API_KEY;\n\n// 검색한 책\nexport const bookDataState = atom<BookDTO[]>({\n  key: \"bookDataState\",\n  default: [],\n  effects_UNSTABLE: [persistAtom],\n});\n\n// 검색어\nexport const searchInfoState = atom({\n  key: \"searchInfoState\",\n  default: \"\",\n});\n\n// 상세보기 책\nexport const bookDetailState = atom({\n  key: \"bookDetailState\",\n  default: [],\n  effects_UNSTABLE: [persistAtom],\n});\n\n// 북마크한 책\nexport const bookmarkState = atom({\n  key: \"bookmark\",\n  default: [],\n  effects_UNSTABLE: [persistAtom],\n});\n\nexport const detailBookSelector = selector({\n  key: \"detailBookSelector\",\n  get: ({ get }) => {\n    const bookState = get(bookDataState);\n    const findItem = bookState.find((item) => item.watch === true);\n    return findItem;\n  },\n  set: ({ set, get }, newValue) => {\n    const bookState = get(bookDataState);\n    const updatedData = bookState.map((item) => {\n      if (item === newValue) {\n        return { ...item, watch: true };\n      }\n      return { ...item, watch: false };\n    });\n    set(bookDataState, updatedData);\n    set(bookDetailState, newValue);\n  },\n});\n\n// watch true 로 바꾸는 기능\nexport const filteredBookSelector = selectorFamily<boolean | undefined, string>(\n  {\n    key: \"filteredBookSelector\",\n    get:\n      (bookCode) =>\n      ({ get }) => {\n        const bookState = get(bookDataState);\n\n        const findItem = bookState?.find((item) => {\n          return item.isbn.split(\" \").join(\"\") === bookCode;\n        });\n        return findItem?.watch;\n      },\n    set:\n      (bookCode) =>\n      ({ set, get }, newValue) => {\n        const bookState = get(bookDataState);\n        console.log(\"set함수\", bookState);\n        const updatedData = bookState?.map((item: any) => {\n          let isbn = item.isbn;\n          isbn = isbn.split(\" \").join(\"\");\n          if (isbn == bookCode) {\n            return { ...item, watch: newValue };\n          }\n          return item;\n        });\n\n        set(bookDataState, updatedData);\n      },\n  }\n);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}